{"version":3,"sources":["webpack:///webpack/bootstrap 478bd70213f29d09887d","webpack:///./app/js/app.js","webpack:///./app/js/location.js"],"names":["base64ToArrayBuffer","base64","binary_string","window","atob","len","length","bytes","Uint8Array","i","charCodeAt","buffer","App","XHR","XMLHttpRequest","XDomainRequest","xhr","markersList","DELAY","clicks","timer","imgUrl","path","init","initHandlers","url","type","data","header","Headers","token","localStorage","getItem","userID","console","log","append","fetch","method","mode","headers","body","JSON","stringify","then","response","json","ref","mymap","L","map","setView","maplayer","tileLayer","addTo","currentPosition","id","addControl","Control","Search","jsonpParam","propertyName","propertyLoc","marker","circleMarker","radius","autoCollapse","autoType","minLength","routing","Routing","control","createMarker","draggableWaypoints","geocodersClassName","addWaypoints","run","navigator","geolocation","watchPosition","onPositionResived","bind","onPositionNotResived","timeout","positionError","document","getElementById","onclick","removeLayer","closeMenu","You","icon","iconUrl","iconSize","popupAnchor","Flag","key","parse","latlng","lat","lng","addMarker","description","File","FileReader","FileList","Blob","addEventListener","outputDateFrom","outputDateUntil","createCustomPin","_handleImageChange","savePin","showPopUp","hidePopUp","centerOnSelf","clearMarkers","authFacebook","test","on","e","setTimeout","flag","setIcon","focus","openMenu","clearTimeout","options","date","Date","allowOldDates","allowFutureDates","datePicker","show","value","getDate","slice","getMonth","getFullYear","calendarOutput","message","cordova","plugins","notification","local","schedule","now","at","getTime","title","text","sound","none","vibrate","beep","Media","play","eventId","isInTheRadius","intersects","setStyle","fillColor","notifyUser","CurrentLocation","Event","getLatLng","distanceTo","getRadius","position","coords","latitude","longitude","lastSeenOn","setItem","setOrigin","overlappingWithEvents","className","indexOf","spliceWaypoints","markerId","descriptionHtml","createElement","innerHTML","wrapper","btn","appendChild","bindPopup","setDestination","removeItem","getWaypoints","latLng","getPlan","setWaypoints","StorageObject","circle","fillOpacity","color","ajax","author","res","swal","html","$","addClass","animation","customClass","src","undefined","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","eachLayer","layer","childNodes","getElementsByTagName","facebookConnectPlugin","login","api","name","_id","error","event","preventDefault","reader","file","target","files","onloadend","result","readAsDataURL","photo","startsAt","endsAt","decodedImg","popupContent","dateFrom","dateUntil","img","Location","promptForPermission","bgGeo","BackgroundGeolocation","callbackFn","location","taskId","finish","failureFn","errorCode","warn","isMoving","configure","desiredAccuracy","distanceFilter","stationaryRadius","locationUpdateInterval","fastestLocationUpdateInterval","activityType","activityRecognitionInterval","stopTimeout","debug","stopOnTerminate","startOnBoot","autoSync","maxDaysToPersist","params","state","enabled","start"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 478bd70213f29d09887d","import Location from './location';\n\nfunction base64ToArrayBuffer(base64) {\n  var binary_string =  window.atob(base64);\n  var len = binary_string.length;\n  var bytes = new Uint8Array( len );\n  for (var i = 0; i < len; i++)        {\n    bytes[i] = binary_string.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n\nclass App {\n  constructor() {\n    this.init();\n    this.initHandlers();\n  }\n\n  XHR = (\"onload\" in new XMLHttpRequest()) ? XMLHttpRequest : XDomainRequest;\n  xhr = new this.XHR();\n\n  markersList = {};\n  DELAY = 175;\n  clicks = 0;\n  timer = null;\n  imgUrl = null;\n\n  //server variables\n\n\n  path = 'http://localhost:9001';\n\n  ajax(url, type, data) {\n    const header = new Headers({\n      'Content-Type': 'application/json',\n      'Accept' : 'application/json'\n    });\n    const token = window.localStorage.getItem('authToken');\n    const userID = window.localStorage.getItem('userID');\n\n    console.log('Facebook ID', userID);\n\n    if (token) {\n      header.append('authorization', 'Bearer ' + token);\n      header.append('userID', userID);\n    }\n\n    return fetch(url, {\n      method: type,\n      mode: 'cors',\n      headers: header,\n      body: JSON.stringify(data)\n    }).then((response) => response.json());\n  }\n\n  init() {\n\n    //TODO\n\n    console.log('ID: ', window.localStorage.getItem('userID'));\n    console.log('token: ', window.localStorage.getItem('authToken'));\n\n    const ref = this;\n    new Location(this);\n    \n    this.mymap = L.map('mapid').setView([31.778124579640565, 35.232188701629646], 18);\n\n    var maplayer = L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/streets-v10/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiMW1wZXJlYyIsImEiOiJjaXpuemgwN2MwMzMxMndrNzhxODJsN2toIn0.Uo549WrORGOAySucvwubsg')\n      .addTo(ref.mymap);\n\n    this.currentPosition = {id: 'YourLocation'};\n\n//adding search\n\n    ref.mymap.addControl( new L.Control.Search({\n      url: 'http://nominatim.openstreetmap.org/search?format=json&q={s}',\n      jsonpParam: 'json_callback',\n      propertyName: 'display_name',\n      propertyLoc: ['lat','lon'],\n      marker: L.circleMarker([0,0],{radius:0}),\n      autoCollapse: true,\n      autoType: false,\n      minLength: 2\n    }) );\n\n///////////////////////////////////////////////////////////////////////////////////////////////////////\n\n// Adding Rout-machine\n\n    this.routing = L.Routing.control({\n      createMarker: function() { return null; },\n      draggableWaypoints: false,\n      geocodersClassName: 'hidden',\n      addWaypoints: false\n    }).addTo(ref.mymap);\n\n    maplayer.id = 'mainLayer';\n\n    this.run();\n\n    if (navigator.geolocation) {\n      ref.currentPosition = navigator.geolocation.watchPosition(this.onPositionResived.bind(this), onPositionNotResived, {timeout: 10000});\n    }\n\n\n    function onPositionNotResived(positionError) {\n      console.log(positionError);\n    }\n\n/////////////////////////////////////////////////////////////////////////////////\n////////////////////////////   Menu Staff  /////////////////////////////////////\n///////////////////////////////////////////////////////////////////////////////\n    \n\n    document.getElementById(\"close-btn\").onclick = function () {\n      ref.mymap.removeLayer(this.markersList['flag'].marker);\n      delete this.markersList['flag'];\n      ref.closeMenu();\n    };\n\n\n/////////////////////////////////////////////////////////////////////////////////\n////////////////////   Creating Your Location Icon   ///////////////////////////\n///////////////////////////////////////////////////////////////////////////////\n\n    this.You = L.icon({\n      iconUrl: 'images/You.gif',\n      iconSize:     [40, 42], // size of the icon\n      popupAnchor:  [0, -16] // point from which the popup shoulCreating Your Location Icond open relative to the iconAnchor\n    });\n\n    this.Flag = L.icon({\n      iconUrl: 'images/flag.png',\n      iconSize:     [30, 50], // size of the icon\n      popupAnchor:  [0, -16] // point from which the popup shoulCreating Your Location Icond open relative to the iconAnchor\n    });\n  }\n\n  run() {\n\n    for (var i = 0; i < localStorage.length; i++) {\n\n      var id = localStorage.key(i);\n\n      var marker = localStorage.getItem(id);\n\n      marker = JSON.parse(marker);\n\n      if (id == 'lastSeenOn') {\n        this.mymap.setView(marker, 18);\n      }\n      else {\n        var latlng = {lat: marker.lat, lng: marker.lng};\n        this.addMarker(latlng, marker.description, id);\n      }\n    }\n\n    if (window.File && window.FileReader && window.FileList && window.Blob) {\n      console.log('File API Works just fine');\n    } else {\n      console.log('File API не поддерживается данным браузером');\n    }\n  }\n\n  initHandlers() {\n\n    document.\n        getElementById('from')\n        .addEventListener('click', this.outputDateFrom.bind(this));\n\n    document.\n    getElementById('until')\n        .addEventListener('click', this.outputDateUntil.bind(this));\n\n    document.\n    getElementById('create-event')\n        .addEventListener('click', this.createCustomPin.bind(this));\n\n    document.\n       getElementById('popup-input-file')\n        .addEventListener('change', this._handleImageChange.bind(this));\n\n    document\n        .getElementById('save-pin')\n        .addEventListener('click', this.savePin.bind(this));\n\n    document\n        .getElementById('options')\n        .addEventListener('click', this.showPopUp.bind(this));\n\n    document\n        .getElementById('cancel')\n        .addEventListener('click', this.hidePopUp.bind(this));\n\n    document\n      .getElementById('location-btn')\n      .addEventListener('click', this.centerOnSelf.bind(this));\n\n    document\n      .getElementById('clear-markers')\n      .addEventListener('click', this.clearMarkers.bind(this));\n\n    document\n        .getElementById('facebook')\n        .addEventListener('click', this.authFacebook.bind(this));\n\n    document\n        .getElementById('test-btn')\n        .addEventListener('click', this.test.bind(this));\n\n    this.mymap.on('click', (e) => {\n\n      this.clicks++;  //count clicks\n\n      if (this.clicks === 1) {\n\n        this.timer = setTimeout(() => {\n\n          var flag = L.marker(e.latlng).addTo(this.mymap);\n          flag.id = 'flag';\n          flag.setIcon(this.Flag);\n\n          if (this.markersList['flag']) {\n            this.mymap.removeLayer(this.markersList['flag'].marker);\n          }\n\n          this.markersList['flag'] = {marker: flag};\n\n          document.getElementById('marker-description').focus();\n\n          this.clicks = 0;             //after action performed, reset counter\n\n        }, this.DELAY);\n\n        this.openMenu();\n\n      } else {\n\n        clearTimeout(this.timer);    //prevent single-click action\n        this.clicks = 0;             //after action performed, reset counter\n      }\n\n    });\n\n    document.getElementById(\"close-btn\").onclick = () => {\n      this.mymap.removeLayer(this.markersList['flag'].marker);\n      delete this.markersList['flag'];\n      this.closeMenu();\n    };\n  }\n\n  calendarOutput(id){\n\n  try {\n    var options = {\n      date: new Date(),\n      mode: 'date',\n      allowOldDates: true,\n      allowFutureDates: true\n    };\n\n    datePicker.show(options, function (date) {\n        document.getElementById(id).value = ('0' + date.getDate()).slice(-2) + \"/\" + ('0' + (date.getMonth() + 1)).slice(-2) + \"/\" + date.getFullYear();\n    });\n\n  }\n  catch(e) {\n    console.log('Data picker not for browsers. DA!');\n  }\n\n}\n\n  outputDateFrom() {\n    this.calendarOutput('from');\n  }\n  outputDateUntil() {\n    this.calendarOutput('until');\n  }\n\n  notifyUser(message) {\n    try {\n      cordova.plugins.notification.local.schedule({\n        id: 'ID-'+Date.now(),\n        at: new Date(new Date().getTime() + 1000),// now + 1s\n        title: 'TEST',\n        text: message,\n        sound: none\n      });\n\n      navigator.notification.vibrate(2500);\n\n      const beep = new Media(\"sounds/beep.wav\");\n      beep.play();\n    }\n    catch(e) {\n      console.log(\"Notifications are not avalible in browser. DA!\");\n    }\n  }\n\n  overlappingWithEvents() {\n    for (let eventId in this.markersList) {\n\n      var marker = this.markersList[eventId].marker;\n      var radius = this.markersList[eventId].radius;\n\n      if (marker.id != 'YourLocation' && marker.id != 'flag') {\n\n        if (this.isInTheRadius(this.currentPosition, radius)) {\n          if (!radius.intersects) {\n            radius.setStyle({fillColor: 'green'});\n            radius.intersects = true;\n            this.notifyUser('User has entered a void');\n          }\n        } else if (radius.intersects) {\n          radius.setStyle({fillColor: 'red'});\n          radius.intersects = false;\n          this.notifyUser('User has exited a void');\n        }\n      }\n    }\n  }\n\n  isInTheRadius(CurrentLocation, Event) {\n    if (CurrentLocation) {\n      return CurrentLocation.getLatLng().distanceTo(Event.getLatLng()) <= Event.getRadius();\n    }\n  }\n\n  onPositionResived(position) {\n    const ref = this;\n    const latlng = {'lat': position.coords.latitude, 'lng': position.coords.longitude};\n    this.currentPosition = this.addMarker(latlng, 'Your current location', 'YourLocation');\n    this.currentPosition.id = 'YourLocation';\n    this.currentPosition.setIcon(this.You);\n    this.lastSeenOn = {'lat': ref.currentPosition.getLatLng().lat, 'lng': ref.currentPosition.getLatLng().lng};\n    localStorage.setItem('lastSeenOn', JSON.stringify(this.lastSeenOn));\n    this.setOrigin(ref.currentPosition.getLatLng());\n    this.overlappingWithEvents();\n\n    if (document.getElementById('location-btn').className.indexOf('spinning') > -1 ) {\n      document.getElementById('location-btn').className = document.getElementById('location-btn').className.slice('spinning '.length);\n      this.centerOnSelf();\n    }\n  }\n\n  setOrigin(latlng) {\n    this.routing.spliceWaypoints(0, 1, latlng);\n  }\n\n  addMarker(latlng, description, markerId) {\n    const ref = this;\n    const descriptionHtml = document.createElement('div');\n    descriptionHtml.innerHTML = description;\n    if (this.markersList[markerId]) {\n      this.mymap.removeLayer(this.markersList[markerId].marker);\n      delete this.markersList[markerId];\n    }\n\n    var marker = L.marker(latlng).addTo(this.mymap);\n\n    marker.id = markerId;\n\n    if (markerId != \"YourLocation\" && markerId != \"flag\") {\n      const wrapper = document.createElement(\"div\");\n      var btn = document.createElement(\"button\");\n      btn.className = \"popup-btn\";\n      btn.onclick = function (id, e) {\n        console.log('id=', id);\n      }.bind(this, markerId);\n      wrapper.appendChild(descriptionHtml);\n      wrapper.appendChild(btn);\n\n      marker.bindPopup(wrapper);\n    }\n\n    marker.on('click', (e) => {\n      this.setDestination(e.latlng);\n    });\n\n    marker.on('contextmenu', function (e) {\n      ref.mymap.removeLayer(this);\n      ref.mymap.removeLayer(ref.markersList[this.id].radius);\n      localStorage.removeItem(this.id);\n      delete ref.markersList[this.id];\n\n      //TODO finish off deleting of a single pin process\n\n\n      if (ref.routing.getWaypoints()[1].latLng &&\n        e.latlng.lat == ref.routing.getWaypoints()[1].latLng.lat &&\n        e.latlng.lng == ref.routing.getWaypoints()[1].latLng.lng) {\n\n        ref.routing.getPlan().setWaypoints([ref.currentPosition.getLatLng()]);\n      }\n    });\n\n    var StorageObject = { 'lat': latlng.lat, 'lng': latlng.lng, 'description': description};\n\n    if (markerId != 'YourLocation') {\n      localStorage.setItem(markerId, JSON.stringify(StorageObject));\n      var radius = L.circle([latlng.lat, latlng.lng], {\n        fillOpacity: 0.1,\n        fillColor: 'red',\n        color: 'none',\n        radius: 100\n      }).addTo(this.mymap);\n      radius['intersects'] = false;\n    }\n\n    this.markersList[markerId] = {marker: marker, radius: radius};\n\n    return marker;\n  }\n\n  setDestination(latlng) {\n    this.routing.spliceWaypoints(1, 1, latlng);\n  }\n\n  /**\n   * Add Pin\n   */\n  savePin() {\n\n    if(window.localStorage.getItem(\"userID\")) {\n\n      var latlng = this.markersList['flag'].marker.getLatLng();\n      var description = document.getElementById('marker-description').value;\n      var id = latlng.lat + '' + latlng.lng;\n      this.addMarker(latlng, description, id);\n      this.mymap.removeLayer(this.markersList['flag'].marker);\n      delete this.markersList['flag'];\n\n      this.ajax(this.path + '/addpin', 'post', {\n        lat: latlng.lat,\n        lng: latlng.lng,\n        description: description,\n        id: id,\n        author: window.localStorage.getItem(\"userID\")\n      }).then((res) => {\n        console.log('addpin', res);\n      });\n\n      this.closeMenu();\n    }\n\n    else {\n      swal({\n        title: 'You should log in first',\n        html: $('<div>')\n            .addClass('some-class')\n            .text('login with your facebook account'),\n        animation: false,\n        customClass: 'animated tada'\n      })\n    }\n  }\n\n\n  showPopUp() {\n    document.getElementById(\"overlay\").className = 'active';\n  }\n\n  hidePopUp() {\n    document.getElementById(\"title\").value   = '';\n    document.getElementById(\"from\").value =    '';\n    document.getElementById(\"until\").value =   '';\n    document.getElementById(\"event-description\").value = '';\n    document.getElementById(\"overlay\").className = '';\n    document.getElementById('popup-file-img').src = \"\";\n    document.getElementById('file-add-ditails').className = '';\n    document.getElementById('popup-input-file').value = \"\";\n    this.imgUrl = undefined;\n  }\n\n  closeMenu() {\n      document.getElementById(\"menu\").className = \"\";\n      document.getElementById(\"marker-description\").value = \"\";\n  }\n\n  centerOnSelf() {\n    this.mymap.setView(this.currentPosition.getLatLng());\n  }\n\n  clearMarkers() {\n\n    let ref = this;\n    swal({\n      title: 'Are you sure?',\n      text: \"You won't be able to revert this!\",\n      type: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#d33',\n      confirmButtonText: 'Yes, clear markers!'\n    }).then(() => {\n\n      ref.mymap.eachLayer((layer) => {\n\n        if (layer.id != 'mainLayer' && layer.id != 'YourLocation') {\n          ref.mymap.removeLayer(layer);\n          delete ref.markersList[layer.id];\n        }\n\n      });\n      if (ref.lastSeenOn) {\n        localStorage.setItem('lastSeenOn', JSON.stringify(ref.lastSeenOn));\n      }\n\n      var childNodes = document.getElementsByTagName(\"input\");\n\n      for (var i = 0; i<childNodes.length; i++) {\n\n        if (childNodes[i].type == 'text') {\n\n          childNodes[i].value = '';\n        }\n      }\n\n      ref.routing.setWaypoints([]);\n\n      this.ajax(this.path + '/clearAll', 'post', {}).then(() => {\n\n      });\n\n      swal(\n        'Deleted!',\n        'Your file has been deleted.',\n        'success'\n      );\n      ref.closeMenu();\n    });\n  }\n\n  test() {\n    this.ajax(this.path + '/pins', 'get').then((data) => {\n      console.log(data);\n    })\n\n  }\n\n  authFacebook() {\n\n    console.log('authFacebook');\n      facebookConnectPlugin.login(['public_profile'], (data) => {\n\n          facebookConnectPlugin.api('me/?fields=id,name', ['public_profile'], (res) => {\n\n            this.ajax(this.path + '/adduser', 'post', {\n              id: res.id,\n              name: res.name\n            }).then((res) => {\n              window.localStorage.setItem('authToken', res.token);\n              window.localStorage.setItem('userID', res._id);\n            });\n\n          },\n              (error) => {\n                console.log('error', error);\n\n          });\n      }, (error) => {\n        console.log('error', error);\n      });\n  }\n\n  _handleImageChange(event) {\n    event.preventDefault();\n    const reader = new FileReader();\n    const file = event.target.files[0];\n\n    reader.onloadend = () => {\n      document.getElementById('popup-file-img').src = reader.result;\n      document.getElementById('file-add-ditails').className = 'hidden';\n      this.imgUrl = reader.result;\n    };\n\n    reader.readAsDataURL(file);\n  }\n\n  createCustomPin(event) {\n\n    var photo = \"\";\n    var startsAt = \"\";\n    var endsAt = \"\";\n    var decodedImg = \"\";\n\n    if( document.getElementById('from').value != \"\") {\n      startsAt =\n          \"<p class='popup-date-start'>\"        +\n          \"Starts at: \"                         +\n          document.getElementById('from').value +\n          \"</p>\";\n    }\n\n    if( document.getElementById('until').value != \"\") {\n      endsAt =\n          \"<p class='popup-date-end'>\"           +\n          \"Ends at: \"                            +\n          document.getElementById('until').value +\n          \"</p>\"\n    }\n\n    if(this.imgUrl) {\n      photo =\n          \"<div class='img-wrapper'>\"         +\n          \"<img src='\"+ this.imgUrl + \"'/>\"   +\n          \"</div>\" ;\n    }\n\n    var popupContent =\n        \"<div class='popup-wrapper'>\"             +\n          \"<div class='popup-header'>\"            +\n              photo                               +\n            \"<div class='popup-header-content'>\"  +\n              \"<h2 class='popup-title'>\"          +\n                document.getElementById('title').value +\n              \"</h2>\"                             +\n              startsAt                            +\n              endsAt                              +\n            \"</div>\"                              +\n          \"</div>\"                                +\n          \"<div class='popup-content'>\"           +\n            \"<p class='popup-description'>\"       +\n              document.getElementById('event-description').value +\n            \"</p>\"                                +\n          \"</div>\"                                +\n        \"</div>\";\n\n    this.addMarker(this.markersList['flag'].marker.getLatLng(), popupContent, this.markersList['flag'].marker.getLatLng().lat + \"\" + this.markersList['flag'].marker.getLatLng().lng);\n\n    this.ajax(this.path + \"/addpin\", 'post', {\n\n      id:  this.markersList['flag'].marker.getLatLng().lat + \"\" + this.markersList['flag'].marker.getLatLng().lng,\n      lat: this.markersList['flag'].marker.getLatLng().lat,\n      lng: this.markersList['flag'].marker.getLatLng().lng,\n      title: document.getElementById('title').value,\n      dateFrom: document.getElementById('from').value,\n      dateUntil: document.getElementById('until').value,\n      description: document.getElementById('event-description').value,\n      img: this.imgUrl,\n      author: window.localStorage.getItem(\"userID\")\n    });\n\n    this.hidePopUp();\n\n    this.mymap.removeLayer(this.markersList['flag'].marker);\n    delete this.markersList['flag'];\n  }\n\n  openMenu() {\n    document.getElementById(\"menu\").className = 'active';\n  }\n}\n\n\nnew App();\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./app/js/app.js","export default class Location {\n  constructor(App) {\n    this.App = App;\n    document.addEventListener('deviceready', this.init.bind(this), false);\n  }\n  \n  init() {\n    const ref = this;\n    cordova.plugins.notification.local.promptForPermission();\n\n    var bgGeo = window.BackgroundGeolocation;\n\n    //This callback will be executed every time a geolocation is recorded in the background.\n    var callbackFn = function(location, taskId) {\n      var coords = location.coords;\n      var lat    = coords.latitude;\n      var lng    = coords.longitude;\n      // console.log('- Location: ', JSON.stringify(location));\n\n      ref.App.onPositionResived(location);\n\n      // $cordovaDatePicker.show(options).then(function(date){\n      //   alert(date);\n      // });\n\n      // Must signal completion of your callbackFn.\n      bgGeo.finish(taskId);\n    };\n\n    // This callback will be executed if a location-error occurs.  Eg: this will be called if user disables location-services.\n    var failureFn = function(errorCode) {\n      console.warn('- BackgroundGeoLocation error: ', errorCode);\n    };\n\n    // Listen to location events & errors.\n    bgGeo.on('location', callbackFn, failureFn);\n\n    // Fired whenever state changes from moving->stationary or vice-versa.\n    bgGeo.on('motionchange', function(isMoving) {\n      console.log('- onMotionChange: ', isMoving);\n    });\n\n    // BackgroundGeoLocation is highly configurable.\n    bgGeo.configure({\n      // Geolocation config\n      desiredAccuracy: 0,\n      distanceFilter: 10,\n      stationaryRadius: 50,\n      locationUpdateInterval: 10000,\n      fastestLocationUpdateInterval: 5000,\n\n      // Activity Recognition config\n      activityType: 'AutomotiveNavigation',\n      activityRecognitionInterval: 5000,\n      stopTimeout: 5,\n\n      // Application config\n      debug: false,\n      stopOnTerminate: false,\n      startOnBoot: true,\n\n      // HTTP / SQLite config\n      url: 'http://posttestserver.com/post.php?dir=cordova-background-geolocation',\n      method: 'POST',\n      autoSync: true,\n      maxDaysToPersist: 1,\n      headers: {\n        \"X-FOO\": \"bar\"\n      },\n      params: {\n        \"auth_token\": \"maybe_your_server_authenticates_via_token_YES?\"\n      }\n    }, function(state) {\n      // This callback is executed when the plugin is ready to use.\n      if (!state.enabled) {\n        bgGeo.start();\n      }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/js/location.js"],"sourceRoot":""}